<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Crystal Docs 1.12.2">
<meta name="crystal_docs.project_version" content="1.8.0">
<meta name="crystal_docs.project_name" content="goban">



<link href="../../css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../js/doc.js"></script>

  <meta name="repository-name" content="goban">
  <title>Goban::QR::Encoder - goban 1.8.0</title>
  <script type="text/javascript">
    CrystalDocs.base_path = "../../";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill="currentColor" fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<input type="checkbox" id="sidebar-btn">
<label for="sidebar-btn" id="sidebar-btn-label">
  <svg class="open" xmlns="http://www.w3.org/2000/svg" height="2em" width="2em" viewBox="0 0 512 512"><title>Open Sidebar</title><path fill="currentColor" d="M80 96v64h352V96H80zm0 112v64h352v-64H80zm0 112v64h352v-64H80z"></path></svg>
  <svg class="close" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 512 512"><title>Close Sidebar</title><path fill="currentColor" d="m118.6 73.4-45.2 45.2L210.7 256 73.4 393.4l45.2 45.2L256 301.3l137.4 137.3 45.2-45.2L301.3 256l137.3-137.4-45.2-45.2L256 210.7Z"></path></svg>
</label>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="../../index.html">
          goban
        </a>
      </h1>

      <span class="project-version">
        1.8.0
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent open current" data-id="goban/Goban" data-name="goban">
      <a href="../../Goban.html">Goban</a>
      
        <ul>
  
  <li class="parent " data-id="goban/Goban/AbstractQR" data-name="goban::abstractqr">
      <a href="../../Goban/AbstractQR.html">AbstractQR</a>
      
        <ul>
  
  <li class=" " data-id="goban/Goban/AbstractQR/Mask" data-name="goban::abstractqr::mask">
      <a href="../../Goban/AbstractQR/Mask.html">Mask</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/AbstractQR/Template" data-name="goban::abstractqr::template">
      <a href="../../Goban/AbstractQR/Template.html">Template</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/AbstractQR/Version" data-name="goban::abstractqr::version">
      <a href="../../Goban/AbstractQR/Version.html">Version</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="goban/Goban/BitStream" data-name="goban::bitstream">
      <a href="../../Goban/BitStream.html">BitStream</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/Canvas" data-name="goban::canvas(t)">
      <a href="../../Goban/Canvas.html">Canvas</a>
      
    </li>
  
  <li class="parent " data-id="goban/Goban/ECC" data-name="goban::ecc">
      <a href="../../Goban/ECC.html">ECC</a>
      
        <ul>
  
  <li class=" " data-id="goban/Goban/ECC/GF" data-name="goban::ecc::gf">
      <a href="../../Goban/ECC/GF.html">GF</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/ECC/GFPoly" data-name="goban::ecc::gfpoly">
      <a href="../../Goban/ECC/GFPoly.html">GFPoly</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/ECC/Level" data-name="goban::ecc::level">
      <a href="../../Goban/ECC/Level.html">Level</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/ECC/RSDeflator" data-name="goban::ecc::rsdeflator">
      <a href="../../Goban/ECC/RSDeflator.html">RSDeflator</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/ECC/RSInflator" data-name="goban::ecc::rsinflator">
      <a href="../../Goban/ECC/RSInflator.html">RSInflator</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="goban/Goban/InputError" data-name="goban::inputerror">
      <a href="../../Goban/InputError.html">InputError</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/InternalError" data-name="goban::internalerror">
      <a href="../../Goban/InternalError.html">InternalError</a>
      
    </li>
  
  <li class="parent " data-id="goban/Goban/MQR" data-name="goban::mqr">
      <a href="../../Goban/MQR.html">MQR</a>
      
        <ul>
  
  <li class="parent " data-id="goban/Goban/MQR/Decoder" data-name="goban::mqr::decoder">
      <a href="../../Goban/MQR/Decoder.html">Decoder</a>
      
        <ul>
  
  <li class=" " data-id="goban/Goban/MQR/Decoder/VersionMismatchError" data-name="goban::mqr::decoder::versionmismatcherror">
      <a href="../../Goban/MQR/Decoder/VersionMismatchError.html">VersionMismatchError</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="goban/Goban/MQR/Encoder" data-name="goban::mqr::encoder">
      <a href="../../Goban/MQR/Encoder.html">Encoder</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/MQR/Mask" data-name="goban::mqr::mask">
      <a href="../../Goban/MQR/Mask.html">Mask</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/MQR/Template" data-name="goban::mqr::template">
      <a href="../../Goban/MQR/Template.html">Template</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/MQR/Version" data-name="goban::mqr::version">
      <a href="../../Goban/MQR/Version.html">Version</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="goban/Goban/PNGExporter" data-name="goban::pngexporter">
      <a href="../../Goban/PNGExporter.html">PNGExporter</a>
      
    </li>
  
  <li class="parent open current" data-id="goban/Goban/QR" data-name="goban::qr">
      <a href="../../Goban/QR.html">QR</a>
      
        <ul>
  
  <li class="parent " data-id="goban/Goban/QR/Decoder" data-name="goban::qr::decoder">
      <a href="../../Goban/QR/Decoder.html">Decoder</a>
      
        <ul>
  
  <li class=" " data-id="goban/Goban/QR/Decoder/VersionMismatchError" data-name="goban::qr::decoder::versionmismatcherror">
      <a href="../../Goban/QR/Decoder/VersionMismatchError.html">VersionMismatchError</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" current" data-id="goban/Goban/QR/Encoder" data-name="goban::qr::encoder">
      <a href="../../Goban/QR/Encoder.html">Encoder</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/QR/Mask" data-name="goban::qr::mask">
      <a href="../../Goban/QR/Mask.html">Mask</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/QR/Template" data-name="goban::qr::template">
      <a href="../../Goban/QR/Template.html">Template</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/QR/Version" data-name="goban::qr::version">
      <a href="../../Goban/QR/Version.html">Version</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="goban/Goban/RMQR" data-name="goban::rmqr">
      <a href="../../Goban/RMQR.html">RMQR</a>
      
        <ul>
  
  <li class="parent " data-id="goban/Goban/RMQR/Decoder" data-name="goban::rmqr::decoder">
      <a href="../../Goban/RMQR/Decoder.html">Decoder</a>
      
        <ul>
  
  <li class=" " data-id="goban/Goban/RMQR/Decoder/VersionMismatchError" data-name="goban::rmqr::decoder::versionmismatcherror">
      <a href="../../Goban/RMQR/Decoder/VersionMismatchError.html">VersionMismatchError</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="goban/Goban/RMQR/Encoder" data-name="goban::rmqr::encoder">
      <a href="../../Goban/RMQR/Encoder.html">Encoder</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/RMQR/Mask" data-name="goban::rmqr::mask">
      <a href="../../Goban/RMQR/Mask.html">Mask</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/RMQR/SizingStrategy" data-name="goban::rmqr::sizingstrategy">
      <a href="../../Goban/RMQR/SizingStrategy.html">SizingStrategy</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/RMQR/SymbolDimension" data-name="goban::rmqr::symboldimension">
      <a href="../../Goban/RMQR/SymbolDimension.html">SymbolDimension</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/RMQR/Template" data-name="goban::rmqr::template">
      <a href="../../Goban/RMQR/Template.html">Template</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/RMQR/Version" data-name="goban::rmqr::version">
      <a href="../../Goban/RMQR/Version.html">Version</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/RMQR/VersionValue" data-name="goban::rmqr::versionvalue">
      <a href="../../Goban/RMQR/VersionValue.html">VersionValue</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="goban/Goban/Segment" data-name="goban::segment">
      <a href="../../Goban/Segment.html">Segment</a>
      
        <ul>
  
  <li class=" " data-id="goban/Goban/Segment/Mode" data-name="goban::segment::mode">
      <a href="../../Goban/Segment/Mode.html">Mode</a>
      
    </li>
  
  <li class=" " data-id="goban/Goban/Segment/Segmenter" data-name="goban::segment::segmenter">
      <a href="../../Goban/Segment/Segmenter.html">Segmenter</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="goban/Goban/SVGExporter" data-name="goban::svgexporter">
      <a href="../../Goban/SVGExporter.html">SVGExporter</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1 class="type-name">

  <span class="kind">module</span> Goban::<wbr>QR::<wbr>Encoder

</h1>











  <h2>
    <a id="extended-modules" class="anchor" href="#extended-modules">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>
    Extended Modules
  </h2>
  <ul class="other-types-list">
    
      <li class="other-type"><a href="../../Goban/QR/Encoder.html">Goban::QR::Encoder</a></li>
    
  </ul>








  <h2>
    <a id="defined-in" class="anchor" href="#defined-in">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>
    Defined in:
  </h2>
  
    
      goban/qr/encoder.cr
    
    <br/>
  











  <h2>
    <a id="instance-method-summary" class="anchor" href="#instance-method-summary">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>
    Instance Method Summary
  </h2>
  <ul class="list-summary">
    
      <li class="entry-summary">
        <a href="#determine_version_and_segments%28text%3AString%2Cecl%3AECC%3A%3ALevel%29-instance-method" class="signature"><strong>#determine_version_and_segments</strong>(text : String, ecl : ECC::Level)</a>
        
          <div class="summary"><p>Returns a tuple of the optimized segments and QR Code version for the given text and error correction level.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#encode_segments%28segments%3AArray%28Segment%29%2Cecl%3AECC%3A%3ALevel%2Cversion%3AVersion%7CInt%29-instance-method" class="signature"><strong>#encode_segments</strong>(segments : Array(Segment), ecl : ECC::Level, version : Version | Int)</a>
        
          <div class="summary"><p>Creates a new QR Code object for the given data segments, error correction level, and QR Code version that is large enough to contain all the data in the segments.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#encode_string%28text%3AString%2Cecl%3AECC%3A%3ALevel%3DECC%3A%3ALevel%3A%3AMedium%29-instance-method" class="signature"><strong>#encode_string</strong>(text : String, ecl : ECC::Level = <span class="t">ECC</span><span class="t">::</span><span class="t">Level</span><span class="t">::</span><span class="t">Medium</span>)</a>
        
          <div class="summary"><p>Creates a new QR Code object for the given string and error correction level.</p></div>
        
      </li>
    
  </ul>



<div class="methods-inherited">
  
</div>








  <h2>
    <a id="instance-method-detail" class="anchor" href="#instance-method-detail">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>
    Instance Method Detail
  </h2>
  
    <div class="entry-detail" id="determine_version_and_segments(text:String,ecl:ECC::Level)-instance-method">
      <div class="signature">
        
        def <strong>determine_version_and_segments</strong>(text : String, ecl : <a href="../../Goban/ECC/Level.html">ECC::Level</a>)

        <a class="method-permalink" href="#determine_version_and_segments%28text%3AString%2Cecl%3AECC%3A%3ALevel%29-instance-method">#</a>
      </div>
      
        <div class="doc">
          
          <p>Returns a tuple of the optimized segments and QR Code version for the given text and error correction level.</p>
        </div>
      
      <br/>
      <div>
        
      </div>
    </div>
  
    <div class="entry-detail" id="encode_segments(segments:Array(Segment),ecl:ECC::Level,version:Version|Int)-instance-method">
      <div class="signature">
        
        def <strong>encode_segments</strong>(segments : Array(<a href="../../Goban/Segment.html">Segment</a>), ecl : <a href="../../Goban/ECC/Level.html">ECC::Level</a>, version : <a href="../../Goban/QR/Version.html">Version</a> | Int)

        <a class="method-permalink" href="#encode_segments%28segments%3AArray%28Segment%29%2Cecl%3AECC%3A%3ALevel%2Cversion%3AVersion%7CInt%29-instance-method">#</a>
      </div>
      
        <div class="doc">
          
          <p>Creates a new QR Code object for the given data segments, error correction level, and QR Code
version that is large enough to contain all the data in the segments. Note that this method
does not check the data length before encoding, so it will just raise <code>Index out of bounds</code>
error if the data does not fit within the given version.
Use <code><a href="../../Goban/PNGExporter.html">PNGExporter</a></code> to generate the PNG image from the QR Code object generated.</p>
<pre><code class="language-crystal">segments <span class="o">=</span> [
  <span class="t">Goban</span><span class="t">::</span><span class="t">Segment</span>.alphanumeric(<span class="s">&quot;HELLO WORLD&quot;</span>),
  <span class="t">Goban</span><span class="t">::</span><span class="t">Segment</span>.byte(<span class="s">&quot;!&quot;</span>),
]
qr <span class="o">=</span> <span class="t">Goban</span><span class="t">::</span><span class="t">QR</span>.encode_segments(segments, <span class="t">Goban</span><span class="t">::</span><span class="t">ECC</span><span class="t">::</span><span class="t">Level</span><span class="t">::</span><span class="t">Low</span>, <span class="t">Goban</span><span class="t">::</span><span class="t">QR</span><span class="t">::</span><span class="t">Version</span>.new(<span class="n">1</span>))
qr.print_to_console
<span class="c"># =&gt; ██████████████    ██  ████  ██████████████</span>
<span class="c">#    ██          ██    ██████    ██          ██</span>
<span class="c">#    ██  ██████  ██  ████  ████  ██  ██████  ██</span>
<span class="c">#    ██  ██████  ██    ██  ██    ██  ██████  ██</span>
<span class="c">#    ██  ██████  ██      ██  ██  ██  ██████  ██</span>
<span class="c">#    ██          ██          ██  ██          ██</span>
<span class="c">#    ██████████████  ██  ██  ██  ██████████████</span>
<span class="c">#                    ████  ████</span>
<span class="c">#    ██████  ████████████████  ████      ██</span>
<span class="c">#        ██    ██                    ██      ██</span>
<span class="c">#      ████  ██  ████████    ██████  ████</span>
<span class="c">#      ██  ██  ██  ████████    ██  ██  ██████</span>
<span class="c">#        ██  ██████  ██      ██  ██████  ██  ██</span>
<span class="c">#                    ██  ████  ██        ██  ██</span>
<span class="c">#    ██████████████  ████████    ████  ████</span>
<span class="c">#    ██          ██  ████  ████    ██  ██</span>
<span class="c">#    ██  ██████  ██  ████████    ██████████████</span>
<span class="c">#    ██  ██████  ██        ██  ██████      ██</span>
<span class="c">#    ██  ██████  ██  ██      ██  ████  ██    ██</span>
<span class="c">#    ██          ██  ████████          ██  ████</span>
<span class="c">#    ██████████████  ██      ██  ████        ██</span></code></pre>
<p>When constructing your own segments, note that it may not result in the segments that has the
shortest data length even if for each character in the source string you choose an encoding type
with the smallest character set that supports that supports it.</p>
        </div>
      
      <br/>
      <div>
        
      </div>
    </div>
  
    <div class="entry-detail" id="encode_string(text:String,ecl:ECC::Level=ECC::Level::Medium)-instance-method">
      <div class="signature">
        
        def <strong>encode_string</strong>(text : String, ecl : <a href="../../Goban/ECC/Level.html">ECC::Level</a> = <span class="t">ECC</span><span class="t">::</span><span class="t">Level</span><span class="t">::</span><span class="t">Medium</span>)

        <a class="method-permalink" href="#encode_string%28text%3AString%2Cecl%3AECC%3A%3ALevel%3DECC%3A%3ALevel%3A%3AMedium%29-instance-method">#</a>
      </div>
      
        <div class="doc">
          
          <p>Creates a new QR Code object for the given string and error correction level.
Setting a higher error correction level makes the QR Code symbol mode resistant
to loss of pixels, but it requires more redundant bits, resulting in a larger
symbol size.
Use <code><a href="../../Goban/PNGExporter.html">PNGExporter</a></code> to generate the PNG image from the QR Code object generated.</p>
<pre><code class="language-crystal">qr <span class="o">=</span> <span class="t">Goban</span><span class="t">::</span><span class="t">QR</span>.encode_string(<span class="s">&quot;Hello World!&quot;</span>, <span class="t">Goban</span><span class="t">::</span><span class="t">ECC</span><span class="t">::</span><span class="t">Level</span><span class="t">::</span><span class="t">Low</span>)
qr.print_to_console
<span class="c"># =&gt; ██████████████  ████    ██  ██████████████</span>
<span class="c">#    ██          ██    ██    ██  ██          ██</span>
<span class="c">#    ██  ██████  ██  ██  ██  ██  ██  ██████  ██</span>
<span class="c">#    ██  ██████  ██  ██    ██    ██  ██████  ██</span>
<span class="c">#    ██  ██████  ██  ██████      ██  ██████  ██</span>
<span class="c">#    ██          ██              ██          ██</span>
<span class="c">#    ██████████████  ██  ██  ██  ██████████████</span>
<span class="c">#                      ████</span>
<span class="c">#    ████████    ██  ██  ██    ██    ██████  ██</span>
<span class="c">#    ██████████    ██  ██    ██████████████  ██</span>
<span class="c">#        ██    ████    ██    ████  ██      ████</span>
<span class="c">#    ████  ██      ██████    ██    ██  ██  ██</span>
<span class="c">#    ████  ██████████  ██████  ████          ██</span>
<span class="c">#                    ████████    ████    ██  ██</span>
<span class="c">#    ██████████████      ██    ████████</span>
<span class="c">#    ██          ██    ██████████  ██  ████</span>
<span class="c">#    ██  ██████  ██    ██  ██          ██████</span>
<span class="c">#    ██  ██████  ██  ██  ██  ██  ██    ██████</span>
<span class="c">#    ██  ██████  ██  ██████  ██    ██    ██</span>
<span class="c">#    ██          ██  ██    ██  ████████      ██</span>
<span class="c">#    ██████████████  ██    ██  ██████    ██</span></code></pre>
<p>QR Code data under the hood is encoded in one or more encoding types, such as Numeric,
Alphanumeric, Byte, and Kanji. Each encoding type has a different set of characters
supported. While Byte mode can express arbitrary types of data (usually interpreted as UTF-8
text, thus it can express any Unicode characters), it often uses more bits to represent a single
codepoint compared to other encoding types which have a limited set of characters supported,
resulting in larger data size and a more challenging QR Code to scan.</p>
<p>This string encoding uses an algorithm to figure out the best segmentation of the encoding
types for the given string to make the resulting data size as small as possible. Here are the
examples:</p>
<pre><code class="language-crystal"><span class="c"># These examples are the optimal segmentations when the EC Level is Medium.</span>
<span class="c"># Note that the Segment object shown in these examples are not the actual Segment object used</span>
<span class="c"># in the Goban&#39;s codebase but they are just pseudo objects.</span>

<span class="s">&quot;0123456789&quot;</span> <span class="c"># =&gt; [Segment(&quot;0123456789&quot;, mode: Numeric)]</span>
<span class="s">&quot;ABCDEF&quot;</span>     <span class="c"># =&gt; [Segment(&quot;ABCDEF&quot;, mode: Alphanumeric)]</span>
<span class="s">&quot;012345A&quot;</span>    <span class="c"># =&gt; [Segment(&quot;012345A&quot;, mode: Alphanumeric)]</span>
<span class="s">&quot;0123456A&quot;</span>   <span class="c"># =&gt; [Segment(&quot;0123456&quot;, mode: Numeric), Segment(&quot;A&quot;, mode: Alphanumeric)]</span>
<span class="s">&quot;こんにちwa、世界！ 123&quot;</span>
<span class="c"># =&gt; [</span>
<span class="c">#   Segment(&quot;こんにち&quot;, mode: Kanji),</span>
<span class="c">#   Segment(&quot;wa&quot;, mode: Byte),</span>
<span class="c">#   Segment(&quot;、世界！&quot;, mode: Kanji),</span>
<span class="c">#   Segment(&quot; 123&quot;, mode: Alphanumeric)</span>
<span class="c"># ]</span></code></pre>
<p>If the type of characters used in your data strings is always the same, you may want to consider
building data segments by yourself so that Goban doesn't have to do extra processing to figure
it out every single time.</p>
<p>The optimal segments and version to hard-code can be figured out by manually executing
<code>Segment::Segmenter.segment_text_optimized_qr</code>. You can hard-code the segments and version based on
its response, and use <code>QR.encode_segments</code> to create QR Codes using that segments and version.</p>
        </div>
      
      <br/>
      <div>
        
      </div>
    </div>
  


</div>

</body>
</html>
